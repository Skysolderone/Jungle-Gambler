# 战斗动画系统测试清单

## 测试准备

1. 确保 `BattleAnimator.gd` 已创建在 `scripts/` 目录
2. 确保 `Battle.gd` 已更新集成动画系统
3. 运行游戏进入战斗场景

## 测试步骤

### 1. 准备阶段测试

**操作**：
- 进入战斗场景
- 观察准备阶段 UI

**预期结果**：
- ✅ 无报错
- ✅ 魂印选择界面正常显示
- ✅ 15秒倒计时正常

### 2. 骰子滚动动画测试

**触发时机**：准备阶段结束，战斗回合开始

**预期效果**：
- ✅ 屏幕中央弹出骰子面板
- ✅ 数字快速切换（1-6）
- ✅ 带旋转晃动效果
- ✅ 最终结果放大显示
- ✅ 1秒后面板淡出

### 3. 魂印激活特效测试

**触发时机**：选中魂印生效时

**预期效果**：
- ✅ 光环从中心扩散
- ✅ 颜色根据魂印品质变化
- ✅ 魂印名称浮现并上升
- ✅ 半透明不遮挡主界面
- ✅ 每个魂印间隔0.3秒

### 4. 积分计算动画测试（玩家）

**触发时机**：骰子滚动后

**预期效果**：
- ✅ 左侧弹出计算面板
- ✅ 逐行显示：
  - 基础力量
  - 骰子点数
  - 结果
  - 魂印标题
  - 各魂印加成（带颜色和发光）
  - 魂印总加成
- ✅ 最终伤害震撼登场
- ✅ 颜色闪烁3次

### 5. 积分计算动画测试（敌人）

**触发时机**：玩家计算完成后

**预期效果**：
- ✅ 右侧弹出计算面板
- ✅ 显示效果与玩家相同
- ✅ 两个面板不重叠

### 6. 伤害数字飘出测试

**触发时机**：积分计算完成后

**预期效果**：

**玩家胜利时（敌人受伤）**：
- ✅ 敌人位置飘出伤害数字
- ✅ 伤害 > 100 时显示暴击样式
  - 字号更大（48px）
  - 金色描边
- ✅ 向上飘动并淡出

**敌人胜利时（玩家受伤）**：
- ✅ 玩家位置飘出伤害数字
- ✅ 普通样式（36px，红色）
- ✅ 向上飘动并淡出

### 7. 屏幕震动测试

**触发时机**：造成伤害时

**预期效果**：
- ✅ 屏幕快速抖动
- ✅ 震动强度与伤害成正比
- ✅ 持续约0.3秒
- ✅ UI元素跟随震动

### 8. 胜利动画测试

**触发时机**：敌人HP归零

**预期效果**：
- ✅ "胜利！"大字弹出
- ✅ 金色文字
- ✅ 缩放动画
- ✅ 颜色闪烁5次
- ✅ 停留约2秒

### 9. 失败动画测试

**触发时机**：玩家HP归零

**预期效果**：
- ✅ "失败..."灰色文字
- ✅ 缓慢下沉效果
- ✅ 淡入显示
- ✅ 停留约2秒

## 性能测试

### 帧率测试

**操作**：
- 打开Godot调试器
- 观察战斗过程中的FPS

**预期结果**：
- ✅ FPS保持在 50+
- ✅ 无明显卡顿
- ✅ 动画流畅

### 内存测试

**操作**：
- 进行10次完整战斗
- 观察内存使用

**预期结果**：
- ✅ 内存无明显增长
- ✅ 无内存泄漏
- ✅ 动画元素正确清理

## 边界情况测试

### 无魂印战斗

**操作**：
- 不选择任何魂印开始战斗

**预期效果**：
- ✅ 积分计算动画正常（只显示基础+骰子）
- ✅ 无魂印标题不显示
- ✅ 其他动画正常

### 多个魂印连续激活

**操作**：
- 选择5个魂印战斗

**预期效果**：
- ✅ 5个魂印依次激活
- ✅ 光环特效不重叠
- ✅ 间隔均匀（0.3秒）

### 快速战斗结束

**操作**：
- 一回合秒杀敌人

**预期效果**：
- ✅ 所有动画正常播放
- ✅ 胜利动画正确触发
- ✅ 无动画中断

## 已知问题

### 字体加载警告

**现象**：
```
ERROR: FreeType: Error loading font: '' (face_index=0)
```

**影响**：不影响动画功能，可忽略

**解决**：确保项目中有默认字体

## 测试结果

日期：_____________

| 测试项 | 通过 | 问题描述 |
|--------|------|----------|
| 准备阶段 | ☐ | |
| 骰子滚动 | ☐ | |
| 魂印激活 | ☐ | |
| 积分计算（玩家） | ☐ | |
| 积分计算（敌人） | ☐ | |
| 伤害飘出 | ☐ | |
| 屏幕震动 | ☐ | |
| 胜利动画 | ☐ | |
| 失败动画 | ☐ | |
| 性能测试 | ☐ | |
| 边界测试 | ☐ | |

## 备注

____________________________________________
____________________________________________
____________________________________________
